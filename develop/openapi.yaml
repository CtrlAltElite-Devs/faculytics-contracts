openapi: 3.0.0
paths:
  /api/v1/health:
    get:
      operationId: HealthController_GetServerHealth_v1
      parameters: []
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                type: string
      tags:
        - Health
  /api/v1/auth/login:
    post:
      operationId: AuthController_Login_v1
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
      tags:
        - Auth
  /api/v1/auth/me:
    get:
      operationId: AuthController_me_v1
      parameters: []
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MeResponse'
      security:
        - accesstoken: []
      tags:
        - Auth
  /api/v1/auth/refresh:
    post:
      operationId: AuthController_Refresh_v1
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequestBody'
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
      tags:
        - Auth
  /api/v1/auth/logout:
    post:
      operationId: AuthController_Logout_v1
      parameters: []
      responses:
        '201':
          description: ''
      security:
        - accesstoken: []
      tags:
        - Auth
  /api/v1/chatkit:
    post:
      operationId: ChatKitController_Handle_v1
      parameters: []
      responses:
        '201':
          description: ''
      security:
        - accesstoken: []
      tags:
        - ChatKit
  /api/v1/enrollments/me:
    get:
      operationId: EnrollmentsController_getMyEnrollments_v1
      parameters:
        - name: page
          required: true
          in: query
          schema:
            type: number
        - name: limit
          required: true
          in: query
          schema:
            type: number
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MyEnrollmentsResponseDto'
      security:
        - accesstoken: []
      summary: Get current user's enrolled courses
      tags:
        - enrollments
  /api/v1/questionnaires:
    post:
      operationId: QuestionnaireController_createQuestionnaire_v1
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateQuestionnaireRequest'
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Questionnaire'
      summary: Create a new questionnaire
      tags:
        - Questionnaires
  /api/v1/questionnaires/{id}/versions:
    post:
      operationId: QuestionnaireController_createVersion_v1
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateVersionRequest'
      responses:
        '201':
          description: Version created successfully
        '404':
          description: Questionnaire not found
        '409':
          description: Draft version already exists
      summary: Create a new version for a questionnaire
      tags:
        - Questionnaires
  /api/v1/questionnaires/{id}/latest-active-version:
    get:
      operationId: QuestionnaireController_getLatestActiveVersion_v1
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      responses:
        '200':
          description: Active version found or null if none exists
        '404':
          description: Questionnaire not found
      summary: Get the latest active version for a questionnaire
      tags:
        - Questionnaires
  /api/v1/questionnaires/versions/{versionId}/publish:
    patch:
      operationId: QuestionnaireController_publishVersion_v1
      parameters:
        - name: versionId
          required: true
          in: path
          schema:
            type: string
      responses:
        '200':
          description: Version published successfully
        '400':
          description: Version already published or invalid schema
        '404':
          description: Version not found
      summary: Publish a questionnaire version
      tags:
        - Questionnaires
  /api/v1/questionnaires/versions/{versionId}/deprecate:
    patch:
      operationId: QuestionnaireController_deprecateVersion_v1
      parameters:
        - name: versionId
          required: true
          in: path
          schema:
            type: string
      responses:
        '200':
          description: Version deprecated successfully
        '400':
          description: Version already deprecated
        '404':
          description: Version not found
      summary: Deprecate a questionnaire version
      tags:
        - Questionnaires
  /api/v1/questionnaires/submissions:
    post:
      operationId: QuestionnaireController_submitQuestionnaire_v1
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitQuestionnaireRequest'
      responses:
        '201':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestionnaireSubmission'
      security:
        - accesstoken: []
      summary: Submit a completed questionnaire
      tags:
        - Questionnaires
  /api/v1/questionnaires/drafts:
    post:
      operationId: QuestionnaireController_saveDraft_v1
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaveDraftRequest'
      responses:
        '201':
          description: Draft saved successfully
        '400':
          description: Invalid data or inactive version
        '404':
          description: Resource not found
      security:
        - accesstoken: []
      summary: Save or update a draft questionnaire
      tags:
        - Questionnaires
    get:
      operationId: QuestionnaireController_getDraft_v1
      parameters:
        - name: versionId
          required: true
          in: query
          schema:
            format: uuid
            type: string
        - name: facultyId
          required: true
          in: query
          schema:
            format: uuid
            type: string
        - name: semesterId
          required: true
          in: query
          schema:
            format: uuid
            type: string
        - name: courseId
          required: false
          in: query
          schema:
            format: uuid
            type: string
      responses:
        '200':
          description: Draft found or null if no draft exists for this context
      security:
        - accesstoken: []
      summary: Get a specific draft by query parameters
      tags:
        - Questionnaires
  /api/v1/questionnaires/drafts/list:
    get:
      operationId: QuestionnaireController_listMyDrafts_v1
      parameters: []
      responses:
        '200':
          description: Drafts retrieved successfully
      security:
        - accesstoken: []
      summary: List all drafts for the current user
      tags:
        - Questionnaires
  /api/v1/questionnaires/drafts/{id}:
    delete:
      operationId: QuestionnaireController_deleteDraft_v1
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      responses:
        '200':
          description: Draft deleted successfully
        '404':
          description: Draft not found
      security:
        - accesstoken: []
      summary: Delete a draft by ID
      tags:
        - Questionnaires
info:
  title: Faculytics API
  description: This is the official API documentation for Faculytics
  version: '1.0'
  contact: {}
tags: []
servers: []
components:
  securitySchemes:
    accesstoken:
      scheme: bearer
      bearerFormat: JWT
      type: http
      name: Authorization
      in: header
  schemas:
    LoginRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
      required:
        - username
        - password
    LoginResponse:
      type: object
      properties:
        token:
          type: string
        refreshToken:
          type: string
      required:
        - token
        - refreshToken
    MeResponse:
      type: object
      properties:
        id:
          type: string
        userName:
          type: string
        moodleUserId:
          type: number
        firstName:
          type: string
        lastName:
          type: string
        userProfilePicture:
          type: string
        fullName:
          type: string
        roles:
          type: array
          items:
            type: string
        campus:
          type: object
          properties:
            id:
              type: string
            name:
              type: string
            code:
              type: string
          required:
            - id
            - code
      required:
        - id
        - userName
        - firstName
        - lastName
        - userProfilePicture
        - fullName
        - roles
    RefreshTokenRequestBody:
      type: object
      properties:
        refreshToken:
          type: string
      required:
        - refreshToken
    CourseShortResponseDto:
      type: object
      properties:
        id:
          type: string
        moodleCourseId:
          type: number
        shortname:
          type: string
        fullname:
          type: string
      required:
        - id
        - moodleCourseId
        - shortname
        - fullname
    EnrollmentResponseDto:
      type: object
      properties:
        id:
          type: string
        role:
          type: string
        course:
          $ref: '#/components/schemas/CourseShortResponseDto'
      required:
        - id
        - role
        - course
    PaginationMeta:
      type: object
      properties:
        totalItems:
          type: number
        itemCount:
          type: number
        itemsPerPage:
          type: number
        totalPages:
          type: number
        currentPage:
          type: number
      required:
        - totalItems
        - itemCount
        - itemsPerPage
        - totalPages
        - currentPage
    MyEnrollmentsResponseDto:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/EnrollmentResponseDto'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
      required:
        - data
        - meta
    CreateQuestionnaireRequest:
      type: object
      properties:
        title:
          type: string
        type:
          enum:
            - FACULTY_IN_CLASSROOM
            - FACULTY_OUT_OF_CLASSROOM
            - FACULTY_FEEDBACK
          type: string
      required:
        - title
        - type
    Questionnaire:
      type: object
      properties:
        title:
          type: string
        status:
          type: string
          default: DRAFT
          enum:
            - DRAFT
            - ACTIVE
            - DEPRECATED
        type:
          type: string
          enum:
            - FACULTY_IN_CLASSROOM
            - FACULTY_OUT_OF_CLASSROOM
            - FACULTY_FEEDBACK
        versions:
          type: object
          default: []
        id:
          type: object
          default: a62add82-7b76-4f6c-97a2-f312b2d1d96d
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.278Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.278Z'
        deletedAt:
          type: object
      required:
        - title
        - status
        - type
        - versions
        - id
        - createdAt
        - updatedAt
    CreateVersionRequest:
      type: object
      properties:
        schema:
          type: object
      required:
        - schema
    SubmitQuestionnaireRequest:
      type: object
      properties:
        versionId:
          type: string
          format: uuid
        respondentId:
          type: string
          format: uuid
        facultyId:
          type: string
          format: uuid
        semesterId:
          type: string
          format: uuid
        courseId:
          type: string
          format: uuid
        answers:
          type: object
          example:
            q1: 5
            q2: 4
        qualitativeComment:
          type: string
      required:
        - versionId
        - respondentId
        - facultyId
        - semesterId
        - answers
    QuestionnaireVersion:
      type: object
      properties:
        questionnaire:
          $ref: '#/components/schemas/Questionnaire'
        versionNumber:
          type: number
        schemaSnapshot:
          type: object
        publishedAt:
          format: date-time
          type: string
        isActive:
          type: boolean
          default: false
        status:
          type: string
          default: DRAFT
          enum:
            - DRAFT
            - ACTIVE
            - DEPRECATED
        id:
          type: object
          default: 1446bcff-58d3-4583-aeb7-616e9048cc0e
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.282Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.282Z'
        deletedAt:
          type: object
      required:
        - questionnaire
        - versionNumber
        - schemaSnapshot
        - isActive
        - status
        - id
        - createdAt
        - updatedAt
    Campus:
      type: object
      properties:
        moodleCategoryId:
          type: number
        code:
          type: string
        name:
          type: string
        semesters:
          type: object
          default: []
        id:
          type: object
          default: cf1a1f09-0df9-4e25-b6b2-451dadacb6d2
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.284Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.284Z'
        deletedAt:
          type: object
      required:
        - moodleCategoryId
        - code
        - semesters
        - id
        - createdAt
        - updatedAt
    Semester:
      type: object
      properties:
        moodleCategoryId:
          type: number
        code:
          type: string
        label:
          type: string
        academicYear:
          type: string
        campus:
          $ref: '#/components/schemas/Campus'
        departments:
          type: object
          default: []
        description:
          type: string
        id:
          type: object
          default: 2c0016c6-4d2d-434a-af0c-a1adcf8b33df
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.286Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.286Z'
        deletedAt:
          type: object
      required:
        - moodleCategoryId
        - code
        - campus
        - departments
        - id
        - createdAt
        - updatedAt
    Department:
      type: object
      properties:
        moodleCategoryId:
          type: number
        code:
          type: string
        name:
          type: string
        semester:
          $ref: '#/components/schemas/Semester'
        programs:
          type: object
          default: []
        id:
          type: object
          default: c19c3ddd-42f3-4b25-a884-aeb39744cc28
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.285Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.285Z'
        deletedAt:
          type: object
      required:
        - moodleCategoryId
        - code
        - semester
        - programs
        - id
        - createdAt
        - updatedAt
    Program:
      type: object
      properties:
        moodleCategoryId:
          type: number
        code:
          type: string
        name:
          type: string
        department:
          $ref: '#/components/schemas/Department'
        courses:
          type: object
          default: []
        id:
          type: object
          default: 979c85cf-9788-4304-b87d-b5cf6b403b91
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.287Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.287Z'
        deletedAt:
          type: object
      required:
        - moodleCategoryId
        - code
        - department
        - courses
        - id
        - createdAt
        - updatedAt
    User:
      type: object
      properties:
        userName:
          type: string
        moodleUserId:
          type: number
        password:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        userProfilePicture:
          type: string
        fullName:
          type: string
        campus:
          $ref: '#/components/schemas/Campus'
        department:
          $ref: '#/components/schemas/Department'
        program:
          $ref: '#/components/schemas/Program'
        moodleTokens:
          type: object
          default: []
        enrollments:
          type: object
          default: []
        institutionalRoles:
          type: object
          default: []
        lastLoginAt:
          format: date-time
          type: string
        isActive:
          type: boolean
        roles:
          type: array
          default: []
          items:
            type: string
            enum:
              - SUPER_ADMIN
              - ADMIN
              - DEAN
              - FACULTY
              - STUDENT
        id:
          type: object
          default: 9407e6b0-9cd1-4d6e-b504-d948095fdb53
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.284Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.284Z'
        deletedAt:
          type: object
      required:
        - userName
        - firstName
        - lastName
        - userProfilePicture
        - moodleTokens
        - enrollments
        - institutionalRoles
        - lastLoginAt
        - isActive
        - roles
        - id
        - createdAt
        - updatedAt
    Course:
      type: object
      properties:
        moodleCourseId:
          type: number
        shortname:
          type: string
        fullname:
          type: string
        program:
          $ref: '#/components/schemas/Program'
        startDate:
          format: date-time
          type: string
        endDate:
          format: date-time
          type: string
        isVisible:
          type: boolean
        timeModified:
          format: date-time
          type: string
        isActive:
          type: boolean
        id:
          type: object
          default: 98c37851-08db-475d-af03-84fdf06f6507
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.288Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.288Z'
        deletedAt:
          type: object
      required:
        - moodleCourseId
        - shortname
        - fullname
        - program
        - startDate
        - endDate
        - isVisible
        - timeModified
        - isActive
        - id
        - createdAt
        - updatedAt
    QuestionnaireSubmission:
      type: object
      properties:
        questionnaireVersion:
          $ref: '#/components/schemas/QuestionnaireVersion'
        respondent:
          $ref: '#/components/schemas/User'
        faculty:
          $ref: '#/components/schemas/User'
        respondentRole:
          type: string
          enum:
            - STUDENT
            - DEAN
        semester:
          $ref: '#/components/schemas/Semester'
        course:
          $ref: '#/components/schemas/Course'
        department:
          $ref: '#/components/schemas/Department'
        program:
          $ref: '#/components/schemas/Program'
        campus:
          $ref: '#/components/schemas/Campus'
        totalScore:
          type: number
        normalizedScore:
          type: number
        qualitativeComment:
          type: string
        submittedAt:
          format: date-time
          type: string
          default: '2026-02-22T11:54:36.281Z'
        facultyNameSnapshot:
          type: string
        facultyEmployeeNumberSnapshot:
          type: string
        departmentCodeSnapshot:
          type: string
        departmentNameSnapshot:
          type: string
        programCodeSnapshot:
          type: string
        programNameSnapshot:
          type: string
        campusCodeSnapshot:
          type: string
        campusNameSnapshot:
          type: string
        courseCodeSnapshot:
          type: string
        courseTitleSnapshot:
          type: string
        semesterCodeSnapshot:
          type: string
        semesterLabelSnapshot:
          type: string
        academicYearSnapshot:
          type: string
        answers:
          type: object
          default: []
        id:
          type: object
          default: fedb992d-09ac-4e06-92c2-52d2d3c39cfa
        createdAt:
          type: object
          default: '2026-02-22T11:54:36.282Z'
        updatedAt:
          type: object
          default: '2026-02-22T11:54:36.282Z'
        deletedAt:
          type: object
      required:
        - questionnaireVersion
        - respondent
        - faculty
        - respondentRole
        - semester
        - department
        - program
        - campus
        - totalScore
        - normalizedScore
        - submittedAt
        - facultyNameSnapshot
        - departmentCodeSnapshot
        - departmentNameSnapshot
        - programCodeSnapshot
        - programNameSnapshot
        - campusCodeSnapshot
        - campusNameSnapshot
        - semesterCodeSnapshot
        - semesterLabelSnapshot
        - academicYearSnapshot
        - answers
        - id
        - createdAt
        - updatedAt
    SaveDraftRequest:
      type: object
      properties:
        versionId:
          type: string
          format: uuid
        facultyId:
          type: string
          format: uuid
        semesterId:
          type: string
          format: uuid
        courseId:
          type: string
          format: uuid
        answers:
          type: object
          example:
            q1: 5
            q2: 4
        qualitativeComment:
          type: string
          maxLength: 10000
      required:
        - versionId
        - facultyId
        - semesterId
        - answers
